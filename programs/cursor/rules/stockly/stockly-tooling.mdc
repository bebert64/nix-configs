---
description: Stockly environment setup, CLI, and tooling
alwaysApply: true
---

## Stockly CLI

- `s` is an alias for `cargo run` in `dev_tools/StocklyCli` (available when in the Main repo).
- Use `s wk <TICKET_IDENTIFIER>` (Notion URL, ShortId, or UUID) to start working on a task. This creates a branch, pushes it, opens a PR, links it to the Notion ticket, and updates the ticket status to "Started".
  - `-w` flag: create a dedicated git worktree instead of switching branches
  - `--only-helps` flag: if the PR only partially addresses the ticket
  - `-s` flag: stash-and-pop if you have uncommitted changes
  - `-b <branch>`: specify a base branch (default: master)
  - Note: The CLI requires `push.default=current` git config to work properly with worktrees
  - After using `-w`, symlinks to untracked files are created in the worktree â€” be careful not to commit them

## Makefile introspection

- `make help`: lists documented targets.
- `make list-targets`: lists all targets.
- `make which target=<NAME>`: shows which Makefile defines a target.
- All three also have `smake` equivalents for SCD targets.

## Compilation

- Use `cargo check` over `cargo build` for fast verification. In the Stockly context, `smake` commands wrap common workflows.

## Monorepo file naming

- Units and libraries use **PascalCase** folder names. Grouping directories use **camelCase**.
- Each package has a `stockly-package.json` at its root indicating its language and type.

## Integration tests

- Rust packages may have a `tintes` binary target for integration tests, registered in a `[[bin]]` section. When present alongside the main binary, set `default-run` to the package name in `Cargo.toml`.

## Proto crate features

- Proto crates must include `default = ["with-serde"]` and `with-serde = ["protobuf/with-serde"]` in `[features]` to enable serde on protobuf messages for error context.
